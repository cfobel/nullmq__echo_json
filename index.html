<html>
<head>
<title>Grid using d3.js</title>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript" src="http://jashkenas.github.com/coffee-script/extras/coffee-script.js"></script>
<script type="text/javascript" src="/dist/lib/stomp.js"></script>
<script type="text/javascript" src="/dist/nullmq.js"></script>
</head>
<body>

<fieldset>
<input name="request" maxlength="100" placeholder="Request (e.g., hello world)" type="text" id="id_request" />
<button name="send_request" id="id_send_request">Send request</button>
</fieldset>

<script type="text/coffeescript">
    class EchoController
        constructor: (@context, @uri) ->
            @echo_be = @context.socket(nullmq.REQ)
            @echo_be.connect(@uri)

        do_request: (message) ->
            if message.length > 0
                @echo_be.send(message)
                @echo_be.recv(alert)

    context = new nullmq.Context('ws://'+window.location.hostname+':9000')
    echo_controller = new EchoController(context, 'tcp://localhost:9001')
    $("#id_send_request").click(() ->
        message = $('#id_request').val()
        echo_controller.do_request(message)
    )
</script>
</body>
</html>
